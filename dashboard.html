<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Operations Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .chart-container { position: relative; height: 300px; }
        .export-btn { transition: all 0.2s ease; }
        .export-btn:hover { transform: translateY(-1px); box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-50 to-blue-50 min-h-screen">
    <div class="container mx-auto px-6 py-8">
        <!-- Header -->
        <div class="mb-8">
            <h1 class="text-3xl font-bold text-gray-800 mb-2">Operations Dashboard</h1>
            <p class="text-gray-600">Real-time overview of frontline operations and task management</p>
            <div class="text-sm text-gray-500 mt-2">Last updated: <span id="lastUpdated"></span></div>
        </div>

        <!-- Dashboard Grid -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            
            <!-- Frontline Staff Deployment -->
            <div class="bg-white rounded-xl shadow-lg p-6 border border-gray-100">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-semibold text-gray-800">Frontline Staff Deployment</h2>
                    <button onclick="exportChart('staffChart')" class="export-btn bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium flex items-center gap-2">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                        Export
                    </button>
                </div>
                <!-- Filter Controls -->
                <div class="flex flex-wrap gap-3 mb-4 p-3 bg-gray-50 rounded-lg">
                    <div class="flex items-center gap-2">
                        <label class="text-sm font-medium text-gray-700">View:</label>
                        <select id="staffTimeframe" onchange="updateStaffChart()" class="text-sm border border-gray-300 rounded px-2 py-1 focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="daily">Daily</option>
                            <option value="weekly" selected>Weekly</option>
                            <option value="monthly">Monthly</option>
                        </select>
                    </div>
                    <div class="flex items-center gap-2">
                        <label class="text-sm font-medium text-gray-700">Date:</label>
                        <input type="date" id="staffDate" onchange="updateStaffChart()" class="text-sm border border-gray-300 rounded px-2 py-1 focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="staffChart"></canvas>
                </div>
                <div class="grid grid-cols-3 gap-4 mt-4">
                    <div class="text-center">
                        <div class="text-2xl font-bold text-blue-600">156</div>
                        <div class="text-sm text-gray-600">Total</div>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl font-bold text-green-600">124</div>
                        <div class="text-sm text-gray-600">In-Task</div>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl font-bold text-orange-600">32</div>
                        <div class="text-sm text-gray-600">Off-Time</div>
                    </div>
                </div>
                <!-- Trend Insight -->
                <div class="mt-4 p-4 bg-blue-50 rounded-lg border-l-4 border-blue-400">
                    <div class="flex items-start">
                        <svg class="w-5 h-5 text-blue-500 mt-0.5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                        </svg>
                        <div>
                            <h4 class="text-sm font-semibold text-blue-800 mb-1">7-Day Trend Analysis</h4>
                            <p class="text-sm text-blue-700">Staff utilization increased by <span class="font-semibold text-green-600">+8.2%</span> compared to last week. In-task ratio improved from 76% to 79.5%, indicating better resource allocation and reduced idle time.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Routine Tasks -->
            <div class="bg-white rounded-xl shadow-lg p-6 border border-gray-100">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-semibold text-gray-800">Routine Tasks</h2>
                    <button onclick="exportChart('routineChart')" class="export-btn bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium flex items-center gap-2">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                        Export
                    </button>
                </div>
                <!-- Filter Controls -->
                <div class="flex flex-wrap gap-3 mb-4 p-3 bg-gray-50 rounded-lg">
                    <div class="flex items-center gap-2">
                        <label class="text-sm font-medium text-gray-700">View:</label>
                        <select id="routineTimeframe" onchange="updateRoutineChart()" class="text-sm border border-gray-300 rounded px-2 py-1 focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="daily">Daily</option>
                            <option value="weekly" selected>Weekly</option>
                            <option value="monthly">Monthly</option>
                        </select>
                    </div>
                    <div class="flex items-center gap-2">
                        <label class="text-sm font-medium text-gray-700">Date:</label>
                        <input type="date" id="routineDate" onchange="updateRoutineChart()" class="text-sm border border-gray-300 rounded px-2 py-1 focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="routineChart"></canvas>
                </div>
                <div class="grid grid-cols-4 gap-2 mt-4">
                    <div class="text-center">
                        <div class="text-xl font-bold text-green-600">89</div>
                        <div class="text-xs text-gray-600">Completed</div>
                    </div>
                    <div class="text-center">
                        <div class="text-xl font-bold text-blue-600">34</div>
                        <div class="text-xs text-gray-600">In-Progress</div>
                    </div>
                    <div class="text-center">
                        <div class="text-xl font-bold text-red-600">12</div>
                        <div class="text-xs text-gray-600">Overdue</div>
                    </div>
                    <div class="text-center">
                        <div class="text-xl font-bold text-gray-600">45</div>
                        <div class="text-xs text-gray-600">Yet to Complete</div>
                    </div>
                </div>
                <!-- Trend Insight -->
                <div class="mt-4 p-4 bg-green-50 rounded-lg border-l-4 border-green-400">
                    <div class="flex items-start">
                        <svg class="w-5 h-5 text-green-500 mt-0.5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM6.293 6.707a1 1 0 010-1.414l3-3a1 1 0 011.414 0l3 3a1 1 0 01-1.414 1.414L11 5.414V13a1 1 0 11-2 0V5.414L7.707 6.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                        </svg>
                        <div>
                            <h4 class="text-sm font-semibold text-green-800 mb-1">7-Day Performance Insight</h4>
                            <p class="text-sm text-green-700">Task completion rate improved by <span class="font-semibold text-green-600">+12%</span> this week. Overdue tasks decreased by 35% while completion efficiency increased, showing strong operational improvements.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ad Hoc/Reservation Tasks -->
            <div class="bg-white rounded-xl shadow-lg p-6 border border-gray-100">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-semibold text-gray-800">Ad Hoc/Reservation Tasks</h2>
                    <button onclick="exportChart('adhocChart')" class="export-btn bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium flex items-center gap-2">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                        Export
                    </button>
                </div>
                <!-- Filter Controls -->
                <div class="flex flex-wrap gap-3 mb-4 p-3 bg-gray-50 rounded-lg">
                    <div class="flex items-center gap-2">
                        <label class="text-sm font-medium text-gray-700">View:</label>
                        <select id="adhocTimeframe" onchange="updateAdhocChart()" class="text-sm border border-gray-300 rounded px-2 py-1 focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="daily">Daily</option>
                            <option value="weekly">Weekly</option>
                            <option value="monthly" selected>Monthly</option>
                        </select>
                    </div>
                    <div class="flex items-center gap-2">
                        <label class="text-sm font-medium text-gray-700">Date:</label>
                        <input type="month" id="adhocDate" onchange="updateAdhocChart()" class="text-sm border border-gray-300 rounded px-2 py-1 focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="adhocChart"></canvas>
                </div>
                <div class="grid grid-cols-3 gap-4 mt-4">
                    <div class="text-center">
                        <div class="text-2xl font-bold text-green-600">67</div>
                        <div class="text-sm text-gray-600">Completed</div>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl font-bold text-red-600">8</div>
                        <div class="text-sm text-gray-600">Overdue</div>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl font-bold text-blue-600">23</div>
                        <div class="text-sm text-gray-600">In-Progress</div>
                    </div>
                </div>
                <!-- Trend Insight -->
                <div class="mt-4 p-4 bg-purple-50 rounded-lg border-l-4 border-purple-400">
                    <div class="flex items-start">
                        <svg class="w-5 h-5 text-purple-500 mt-0.5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M12 7a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0V8.414l-4.293 4.293a1 1 0 01-1.414 0L8 10.414l-4.293 4.293a1 1 0 01-1.414-1.414l5-5a1 1 0 011.414 0L11 10.586 14.586 7H12z" clip-rule="evenodd"></path>
                        </svg>
                        <div>
                            <h4 class="text-sm font-semibold text-purple-800 mb-1">Monthly Trend Analysis</h4>
                            <p class="text-sm text-purple-700">Ad hoc task volume increased by <span class="font-semibold text-orange-600">+18%</span> this month, but completion rate maintained at 68%. Response time improved by 15 minutes on average, showing better agility in handling urgent requests.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Daily Ad Hoc Numbers -->
            <div class="bg-white rounded-xl shadow-lg p-6 border border-gray-100">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-semibold text-gray-800">Daily Ad Hoc Numbers</h2>
                    <button onclick="exportChart('dailyChart')" class="export-btn bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium flex items-center gap-2">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                        Export
                    </button>
                </div>
                <!-- Filter Controls -->
                <div class="flex flex-wrap gap-3 mb-4 p-3 bg-gray-50 rounded-lg">
                    <div class="flex items-center gap-2">
                        <label class="text-sm font-medium text-gray-700">View:</label>
                        <select id="dailyTimeframe" onchange="updateDailyChart()" class="text-sm border border-gray-300 rounded px-2 py-1 focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="daily">Daily</option>
                            <option value="weekly" selected>Weekly</option>
                            <option value="monthly">Monthly</option>
                        </select>
                    </div>
                    <div class="flex items-center gap-2">
                        <label class="text-sm font-medium text-gray-700">Date:</label>
                        <input type="date" id="dailyDate" onchange="updateDailyChart()" class="text-sm border border-gray-300 rounded px-2 py-1 focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="dailyChart"></canvas>
                </div>
                <div class="mt-4 text-center">
                    <div class="text-3xl font-bold text-purple-600">98</div>
                    <div class="text-sm text-gray-600">Total Ad Hoc Tasks Today</div>
                </div>
                <!-- Trend Insight -->
                <div class="mt-4 p-4 bg-orange-50 rounded-lg border-l-4 border-orange-400">
                    <div class="flex items-start">
                        <svg class="w-5 h-5 text-orange-500 mt-0.5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-8.293l-3-3a1 1 0 00-1.414 0l-3 3a1 1 0 001.414 1.414L9 9.414V13a1 1 0 102 0V9.414l1.293 1.293a1 1 0 001.414-1.414z" clip-rule="evenodd"></path>
                        </svg>
                        <div>
                            <h4 class="text-sm font-semibold text-orange-800 mb-1">Weekly Pattern Analysis</h4>
                            <p class="text-sm text-orange-700">Daily ad hoc requests peaked on <span class="font-semibold">Saturday (103)</span> and are <span class="font-semibold text-blue-600">+14%</span> higher than last week's average. Weekend demand shows consistent upward trend, suggesting need for enhanced weekend staffing.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Summary Cards -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-8">
            <div class="bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl p-6 text-white">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-blue-100 text-sm">Total Staff Active</p>
                        <p class="text-3xl font-bold">124</p>
                    </div>
                    <div class="bg-white bg-opacity-20 rounded-full p-3">
                        <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                    </div>
                </div>
            </div>
            
            <div class="bg-gradient-to-r from-green-500 to-green-600 rounded-xl p-6 text-white">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-green-100 text-sm">Tasks Completed</p>
                        <p class="text-3xl font-bold">156</p>
                    </div>
                    <div class="bg-white bg-opacity-20 rounded-full p-3">
                        <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                        </svg>
                    </div>
                </div>
            </div>
            
            <div class="bg-gradient-to-r from-orange-500 to-orange-600 rounded-xl p-6 text-white">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-orange-100 text-sm">Pending Tasks</p>
                        <p class="text-3xl font-bold">20</p>
                    </div>
                    <div class="bg-white bg-opacity-20 rounded-full p-3">
                        <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                        </svg>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Set last updated time and initialize dates
        document.getElementById('lastUpdated').textContent = new Date().toLocaleString();
        
        // Set default dates
        const today = new Date().toISOString().split('T')[0];
        const thisMonth = new Date().toISOString().slice(0, 7);
        document.getElementById('staffDate').value = today;
        document.getElementById('routineDate').value = today;
        document.getElementById('adhocDate').value = thisMonth;
        document.getElementById('dailyDate').value = today;

        // Sample data for different timeframes
        const sampleData = {
            staff: {
                daily: { inTask: [124], offTime: [32] },
                weekly: { inTask: [124], offTime: [32] },
                monthly: { inTask: [3720], offTime: [960] }
            },
            routine: {
                daily: { completed: [89], inProgress: [34], overdue: [12], yetToComplete: [45] },
                weekly: { completed: [623], inProgress: [238], overdue: [84], yetToComplete: [315] },
                monthly: { completed: [2492], inProgress: [952], overdue: [336], yetToComplete: [1260] }
            },
            adhoc: {
                daily: { completed: [67], overdue: [8], inProgress: [23] },
                weekly: { completed: [469], overdue: [56], inProgress: [161] },
                monthly: { completed: [1876], overdue: [224], inProgress: [644] }
            },
            daily: {
                daily: { labels: ['Today'], data: [98] },
                weekly: { labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'], data: [85, 92, 78, 96, 89, 103, 98] },
                monthly: { labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'], data: [645, 672, 598, 689] }
            }
        };

        // Chart configurations
        const chartOptions = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'bottom',
                    labels: {
                        padding: 20,
                        usePointStyle: true
                    }
                }
            }
        };

        // Staff Deployment Chart
        const staffCtx = document.getElementById('staffChart').getContext('2d');
        const staffChart = new Chart(staffCtx, {
            type: 'doughnut',
            data: {
                labels: ['In-Task', 'Off-Time'],
                datasets: [{
                    data: [124, 32],
                    backgroundColor: ['#10B981', '#F59E0B'],
                    borderWidth: 0,
                    cutout: '60%'
                }]
            },
            options: chartOptions
        });

        // Routine Tasks Chart
        const routineCtx = document.getElementById('routineChart').getContext('2d');
        const routineChart = new Chart(routineCtx, {
            type: 'bar',
            data: {
                labels: ['Completed', 'In-Progress', 'Overdue', 'Yet to Complete'],
                datasets: [{
                    data: [89, 34, 12, 45],
                    backgroundColor: ['#10B981', '#3B82F6', '#EF4444', '#6B7280'],
                    borderRadius: 8,
                    borderSkipped: false
                }]
            },
            options: {
                ...chartOptions,
                scales: {
                    y: {
                        beginAtZero: true,
                        grid: {
                            color: '#F3F4F6'
                        }
                    },
                    x: {
                        grid: {
                            display: false
                        }
                    }
                }
            }
        });

        // Ad Hoc Tasks Chart
        const adhocCtx = document.getElementById('adhocChart').getContext('2d');
        const adhocChart = new Chart(adhocCtx, {
            type: 'pie',
            data: {
                labels: ['Completed', 'Overdue', 'In-Progress'],
                datasets: [{
                    data: [67, 8, 23],
                    backgroundColor: ['#10B981', '#EF4444', '#3B82F6'],
                    borderWidth: 0
                }]
            },
            options: chartOptions
        });

        // Daily Ad Hoc Numbers Chart
        const dailyCtx = document.getElementById('dailyChart').getContext('2d');
        const dailyChart = new Chart(dailyCtx, {
            type: 'line',
            data: {
                labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                datasets: [{
                    label: 'Ad Hoc Tasks',
                    data: [85, 92, 78, 96, 89, 103, 98],
                    borderColor: '#8B5CF6',
                    backgroundColor: 'rgba(139, 92, 246, 0.1)',
                    borderWidth: 3,
                    fill: true,
                    tension: 0.4,
                    pointBackgroundColor: '#8B5CF6',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 2,
                    pointRadius: 6
                }]
            },
            options: {
                ...chartOptions,
                scales: {
                    y: {
                        beginAtZero: true,
                        grid: {
                            color: '#F3F4F6'
                        }
                    },
                    x: {
                        grid: {
                            display: false
                        }
                    }
                }
            }
        });

        // Chart update functions
        function updateStaffChart() {
            const timeframe = document.getElementById('staffTimeframe').value;
            const date = document.getElementById('staffDate').value;
            const dateInput = document.getElementById('staffDate');
            
            // Update date input type based on timeframe
            if (timeframe === 'monthly') {
                dateInput.type = 'month';
                if (!dateInput.value.includes('-')) dateInput.value = thisMonth;
            } else {
                dateInput.type = 'date';
                if (dateInput.value.includes('-') && dateInput.value.length === 7) dateInput.value = today;
            }
            
            const data = sampleData.staff[timeframe];
            staffChart.data.datasets[0].data = [data.inTask[0], data.offTime[0]];
            staffChart.update();
        }

        function updateRoutineChart() {
            const timeframe = document.getElementById('routineTimeframe').value;
            const date = document.getElementById('routineDate').value;
            const dateInput = document.getElementById('routineDate');
            
            // Update date input type based on timeframe
            if (timeframe === 'monthly') {
                dateInput.type = 'month';
                if (!dateInput.value.includes('-')) dateInput.value = thisMonth;
            } else {
                dateInput.type = 'date';
                if (dateInput.value.includes('-') && dateInput.value.length === 7) dateInput.value = today;
            }
            
            const data = sampleData.routine[timeframe];
            routineChart.data.datasets[0].data = [data.completed[0], data.inProgress[0], data.overdue[0], data.yetToComplete[0]];
            routineChart.update();
        }

        function updateAdhocChart() {
            const timeframe = document.getElementById('adhocTimeframe').value;
            const date = document.getElementById('adhocDate').value;
            const dateInput = document.getElementById('adhocDate');
            
            // Update date input type based on timeframe
            if (timeframe === 'monthly') {
                dateInput.type = 'month';
                if (!dateInput.value.includes('-')) dateInput.value = thisMonth;
            } else {
                dateInput.type = 'date';
                if (dateInput.value.includes('-') && dateInput.value.length === 7) dateInput.value = today;
            }
            
            const data = sampleData.adhoc[timeframe];
            adhocChart.data.datasets[0].data = [data.completed[0], data.overdue[0], data.inProgress[0]];
            adhocChart.update();
        }

        function updateDailyChart() {
            const timeframe = document.getElementById('dailyTimeframe').value;
            const date = document.getElementById('dailyDate').value;
            const dateInput = document.getElementById('dailyDate');
            
            // Update date input type based on timeframe
            if (timeframe === 'monthly') {
                dateInput.type = 'month';
                if (!dateInput.value.includes('-')) dateInput.value = thisMonth;
            } else {
                dateInput.type = 'date';
                if (dateInput.value.includes('-') && dateInput.value.length === 7) dateInput.value = today;
            }
            
            const data = sampleData.daily[timeframe];
            dailyChart.data.labels = data.labels;
            dailyChart.data.datasets[0].data = data.data;
            dailyChart.update();
        }

        // Export functionality
        function exportChart(chartId) {
            const canvas = document.getElementById(chartId);
            const link = document.createElement('a');
            link.download = `${chartId}_${new Date().toISOString().split('T')[0]}.png`;
            link.href = canvas.toDataURL();
            link.click();
            
            // Show success message
            const button = event.target.closest('button');
            const originalText = button.innerHTML;
            button.innerHTML = '<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg> Exported!';
            button.classList.add('bg-green-600');
            
            setTimeout(() => {
                button.innerHTML = originalText;
                button.classList.remove('bg-green-600');
            }, 2000);
        }

        // Auto-refresh data every 30 seconds (simulation)
        setInterval(() => {
            document.getElementById('lastUpdated').textContent = new Date().toLocaleString();
        }, 30000);
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'967955dc348504f6',t:'MTc1MzkyNTQ3OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
